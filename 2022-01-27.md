architecture 아키텍처

monolithic 시스템(모놀리식)

비즈니스 민첩성 : 빠른 비즈니스 흐름 변화, 고객 피드백 서비스 개선 런칭

Devops 조직 : 하나의 팀에서 여러 역할을 수행하는 사람들이 같이 있다.

enterprise 엔터프라이즈 - 기업,회사

하드웨어가 클라우드 환경으로 변화

scale-up 수직 확장 : 초기부터 사용량 증가를 예상하고 큰 물리적 인프라를 준비
scale-out 수평 확장 : 이벤트 발생 시 전체 시스템을 복사하여 증설시키는 방법

클라우드 네이티브 인프라
클라우드 네이티브 어플리케이션

1990년대 후반부터 발전한 객체 지향 분석 설계, 컴포넌트 기반 개발,
서비스 지향 아키텍처 SOA
Service Oriented Architecture

공통점 : 소프트웨어 설계 시 서비스 중심을 설계를 지향

차이점 : 
서비스 오너십 - 독립된 팀 / 공유 미들웨어 중심으로 협업
서비스 크기 - 비즈니스 단위 / 좀 더 작은 서비스
서비스 공유 측면 - API 필요시 호출 / UDDAI 서비스 저장소나 미들웨어를 두고 통합하여 여러개의 서비스를 공유
서비스 통신 방식 - 서비스 제공자가 노출한 Restful API를 호출하여 결과 값을 활용, 구현 쉽고 클라이언트에 영향이 크게 발생하지 않는다 / WSDL이라는 명세와 SOAP이라는 프로토콜을 이용하여 통신, 만약 WSDL 명세가 변경되면 이를 참조하는 클라이언트들이 모두 영향을 받게 된다
저장소 - 서비스 상 별도의 저장소를 두고 인터페이스만을 통해 데이터를 캡슐화하고 제한, 분리 대체 쉬움 / 통합 저장소 사용

monolith(모노리스) : 하나의 단위로 개발되는 일체식 어플리케이션 설계

폴리그랏(Polyhlot) : 인터페이스 만족 시 서비스 안의 기술은 자율적으로 선택할 수 있음

---------
1주차 3차시
## <마이크로서비스의 특징> 
    - 마틴 파울러 9가지 특성

1. Biz 역량 기반 팀
멜빈 콘웨이의 콘웨이 법칙 : 시스템 개발 시 항상 시스템의 모양이 팀의 구조를 반영

역할 또는 기술별로 팀이 별도로 존재하는 것이 아니라 업무 중심으로 팀을 이룸

cross-functional 팀

느슨한 연계

2. 분권 거버넌스
아마존 모토 built in, run it
빠르게 제품을 만드는 것을 목적
중앙에 강력한 표준이나 절차의 준수를 강요하지 않음

3. 프로젝트가 아니라 제품
기존은 대부분 프로젝트 단위 - 폭포수 모델, 빅뱅 방식
운영을 포함한 전체 라이프사이클을 책임져야 한다
Agile개발 방식

iteration : 반복 / 스프린트

4. 인프라 자동화
DevOps 개발 환경

-------------
4주차

5. 분권 데이터 관리
모노리스 - 단일 통합 데이터베이스 - 단일 데이터베이스를 유지하는 방식은 벤더의 라이센서 모델과 데이터베이스의 기능 확장에 뿌리를 두고 있다.

Polyglot Persistence 접근 방법 선택, 서비스별로 데이터베이스를 갖도록 설계를 합니다.

다른 서비스의 저장소를 직접 호출할 수가 없고 API를 통해서만 접근해야 함
이 경우, 데이터 일관성 문제 등장
ex) 주문, 배송 서비스
    동시적인 트랜잭션 처리를 하면 독립적인 서비스 제공이 어렵게 된다
    따라서 트랜잭션이 아닌 협업을 강조
    Eventual Transaction, 결과적 일관성 : 두 서비스의 데이터가 일시적으로 불일치하는 시점에 있고 일관성이 없는 상태이지만, 결국에는 두 데이터가 같아진다는 개념
    
    보통 이벤트와 Q를 써서 해결
    상품 주문 이벤트 Q에 보내고 자신의 수행 작업 완료

6. 똑똑한 끝지점 단순한 파이프
   SOA - UDDDI 및 ESB라는 서비스 채널 사용

   smart endpoints and dumbpipes 방식 선호
   : Domain Logic은 서비스 속에서 응집성 높게 유지되어야 하고, 각각의 서비스의 연결은 느슨해야 한다는 것을 의미

REST와 같은 단순한 도구 선호

Rabbit MQ나 Zero MQ 같은 가벼운 메시지 버스를 주로 사용

호출이 적은 거친 입자의 인터페이스 방식 사용

7. 실패를 위한 설계

자동으로 테스트 할 수 있는 환경, 실시간 모니터링 체계

서킷 브레이크 패턴 : 회로 차단기처럼 각각의 서비스를 모니터링하고 있다가 하나의 서비스가 다운되거나 실패되면 이를 호출하는 서비스의 연계를 차단하고 이에 적절한 대응을 하기 위해 만드는 것을 의미


----
=> 점진 반복적인 개발 프로세스, 유연하고 자동화된 개발환경, 자율적인 Biz 역량기반 개발조직이 필요함

----------------
2-1

## 소프트웨어 아키텍처의 의미와 마이크로서비스 아키텍처에서 말하는 내외부 아키텍처의 의미, 예전의 아키텍처링 양상과 최근의 아키텍처링 양상이 어떻게 변했는지

Architecturing 아키텍처링 : 시스템 구축을 위한 여러가지 비기능 요건 - (문제 영역이 되는) 성능, 가용성, 보안, 유지보수성, 확장성 등을 만족하도록 여러가지 해법을 정의하는 과정

소프트웨어 아키텍처 : 소프트웨어를 구성하는 요소와 그 구성요소 간의 관계를 정의하는 것

마이크로서비스 아키텍처는 클라우드라는 가상의 인프라를 활용하여 구조화하는 것이기 때문에 클라우드의 특징을 고려하여 설계되어야 한다.

변화에 언제든지 대응할 수 있는 유연성

Infra 인프라 Platform 플랫폼 Application 애플리케이션

MSA 아우터 아키텍처 : 인프라 영역, 플랫폼, 애플리케이션 영역 서비스들의 관계를 정의하는 것(마이크로서비스가 운영되는 환경을 정의하는 과정)

하드웨어가 되는 인프라 위에 애플리케이션을 구동하기 위해 플랫폼이 올라가고 그 플랫폼 위에 애플리케이션인 서비스가 구동되는 관계

MSA 이너 아키텍처
 : 실제로 비즈니스가 실행되는 각각의 마이크로서비스 내의 구조도 유연하게 정의해야 한다

예전에는 아키텍처의 구성요소들을 각 기업이나 프로젝트에 직접 구축하는 일이 많았다.

오픈 소스나 오픈 소스를 베이스로 한 상용 제품들 다양화

최근 아키텍처링은 필요한 영역에 적절한 솔루션을 선택하고 조합하는 과정으로 바뀜

패턴 : 어떤 문제 영역에 대한 검증되고 정의된 유용한 해법

(인프라 패턴, 애플리케이션 인프라 패턴, 애플리케이션 패턴)

----

### 2-2

## 아우터 아키텍처를 구성하는 인프라 영역, 플랫폼 영역, DevOps 환경에 대해

MSA에서 인프라 영역 - 클라우드 환경

서비스는 레이어별로 여러가지가 있다. 인프라로서의 서비스 - IaaS, 플랫폼으로서의 서비스 - Paas로 나뉨

예전에는 힘들게 구축했던 인프라를 AWS, 구글, 마이크로소프트, IBM 등 세계적인 플랫폼 사업자들이 자동화된 기능으로 제공

Sk에서는 클라우드Z라는 서비스 제공
ex) 시스템의 자원 구성, 할당, 관리, 모니터링 등 일련의 작업들을 몇 번 만의 버튼 클릭만으로 자동화, 시각화해서 제공

유연하게 결합 가능
- 상호 독립적이나 호환되도록 모두 유연한 구조로 만들기 때문

플랫폼 영역에서는 가상 머신과 컨테이너를 기반으로 한 Paas 제품을 놓고 선택에 대한 고민을 많이 한다.

차이점 - 가상화는 하이퍼바이저라는 소프트웨어를 이용해서 하나의 시스템에서 여러 개의 운영 체제를 사용하는 기술

컨테이너는 하이퍼바이저 없이 컨테이너 엔진을 사용해 가상의 격리된 공간을 생성. 즉, 게스트 OS가 있느냐 없느냐가 가장 큰 차이

가상화는 게스트 운영체제 설치와 관련 라이브러리 설치 같은 오버헤드가 발생하게 됨

따라서 마이크로서비스 같은 작은 서비스를 패키지하고 배포하기에는 컨테이너가 더 적절하다.

도커

컨테이너를 관리하기 위한 기술 : 컨테이너 오케스트레이션

구글의 kubernates(쿠버네이트)가 가장 인기


DevOps : 개발과 운영이 분리되지 않은 개발과 동시에 운영을 할 수 있는 조직, 그 문화

Q. 클라우드 환경이 플랫폼인가? 뭐지?

CICD : 자동화된 빌드, 배포 작업
CI (Continuous Integration, 지속적 통합) : 자동으로 통합하고 테스트하고 레포트로 남기는 활동
CD (Continuous Delivery, Continuous Deployment) : 실행 환경에 자동으로 배포

파이프라인 : 통합 및 배포까지 일련의 프로세스를 하나로 연계하여 자동화하고 시각화된 프로세스를 구축하는 것

빌드, 유닛 테스트, 정적 분석, (UI테스트, 통합 테스트, 배포 승인 프로세스 등 추가 설계 가능) 배포

빌드 배포 파이프라인 설계 : 어떠한 도구들을 활용할지 결정하고 그 연계 정의를 해야 한다.
----
### 2-3

## 아우터 아키텍처의 애플리케이션 영역을 구성하는 마이크로서비스 관리를 위한 기반 서비스

켄트 벡 XP방법론 1999년도 소개(CI 개념)
켄트 벡, 스크럼의 켄 슈와버 에자일 선언 2001년도
--> 거대한 계획 프로세스 대신 빠른 실패와 피드백을 기반으로 하는 실용적인 실천 방법 선호

AWS IaaS 개념으로 2006년 EC2를 발표
넷플릭스가 스트리밍 사업 시작
아마존의 클라우드 서비스인 AWS로 시스템을 이동하기 시작

데이터베이스 스토리지가 한 번 크게 망가져서 서비스가 큰 장애를 겪게 됨

이를 계기로 넷플릭스는 큰 덩어리의 모노리식 시스템에서 마이크로서비스 기반의 시스템으로의 전환을 시작

운영 어려움 해결을 위해 여러 서비스 및 도구들 개발, 오픈 소스로 공개 - 넷플릭스 OSS
- 로드 밸런싱을 위한 리본, 모니터링을 위한 히스트릭스, 서비스 등록을 위한 유레카 등

2013 도커
이쯤 스프링 부트

최근 도커 컨테이너 오케스트레이션 기술은 구글의 쿠버네티스 등장

마이크로서비스 애플리케이션 패턴 - API 게이트웨이, 서비스 디스커버리, 모니터링, 트레이싱 등

넷플릭스 OSS를 더 쉽게 쓸 수 있도록 스프링 진영의 피보탈사가 기존 스프링부트 프레임워크 상에서 잘 돌아갈 수 있게 래핑한 도구 - 스프링 클라우드 

기반 서비스 : 줄, 유레카, 히스트릭스, 리본 등의 넷플릭스 오픈 소스를 스프링 부트 기반으로 사용하기 쉽도록 통합....?

### 비즈니스를 구현한 마이크로서비스 서비스와 기반 서비스의 활동 흐름

서버에서 가져오며 인스턴스로 뜸 -> 동시에 resist 서비스에 본인의 물리 주소 등록하게 됨, 이때 API 게이트에는 보안을 위해 인증 인가 처리도 하고 로드 밸런싱도 진행
운영 관리를 위해 모니터링과 트레이싱도 됨

다양한 클라이언트가 개별 서비스에 액세스하기 위해서는 단일 진입점을 만들어 놓으면 효율적이다.
ex) 각 클라이언트에서 서로 다른 API를 제공할 수도 있고, 인증 인가같이 보안 처리를 한 곳에서 처리 할 수가 있다.
또한 일정 시간 동안 서비스 요청에 대한 반응이 없으면 기존 요청 경로를 차단하고 다른 경로로 요청 경로를 변경하는 기능을 가동하여 서비스가 정상적으로 수행되게 해야 한다.
또 정상적으로 동작하던 서비스에 문제가 발생하여 서비스 요청에 대한 응답 지원이 발생하면 정상적인 다른 서비스로 욫어 경로를 변경하는 기능이 작동되게 해야 한다.

이렇게 서비스 가용성을 위한 방법을 서비스 라우팅이라고 한다.
라우팅 기능은 L4 같은 하드웨어 장비로 구현할 수도 있고 이렇게 소프트웨어로 구현할 수도 있다.

https://ucloud.lguplus.co.kr/